"use strict";(self.webpackChunkfuriku_docs=self.webpackChunkfuriku_docs||[]).push([[3730],{276:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>l,contentTitle:()=>o,default:()=>u,frontMatter:()=>c,metadata:()=>i,toc:()=>a});const i=JSON.parse('{"id":"business-module","title":"\ud83c\udfea M\xf3dulo de Negocios (Tenants)","description":"El m\xf3dulo de negocios (o tenants) en Furiku representa a cada cliente del sistema: cafeter\xedas, restaurantes peque\xf1os, dark kitchens, food trucks, etc.","source":"@site/docs/business-module.md","sourceDirName":".","slug":"/business-module","permalink":"/furiku-docs/docs/business-module","draft":false,"unlisted":false,"editUrl":"https://github.com/furiku/furiku-docs/edit/main/docs/business-module.md","tags":[],"version":"current","frontMatter":{"id":"business-module","title":"\ud83c\udfea M\xf3dulo de Negocios (Tenants)","sidebar_label":"M\xf3dulo de Negocios"},"sidebar":"tutorialSidebar","previous":{"title":"M\xf3dulo de Usuarios","permalink":"/furiku-docs/docs/user-module"},"next":{"title":"Auditor\xeda y Soft Delete","permalink":"/furiku-docs/docs/soft-delete-audit"}}');var d=s(4848),r=s(8453);const c={id:"business-module",title:"\ud83c\udfea M\xf3dulo de Negocios (Tenants)",sidebar_label:"M\xf3dulo de Negocios"},o=void 0,l={},a=[{value:"\ud83e\udde9 \xbfQu\xe9 es un <code>Business</code>?",id:"-qu\xe9-es-un-business",level:2},{value:"\ud83e\uddfe Campos principales en <code>Business</code>",id:"-campos-principales-en-business",level:2},{value:"\ud83d\udce6 \xbfQu\xe9 representa un <code>tenant</code>?",id:"-qu\xe9-representa-un-tenant",level:2},{value:"\ud83d\udee0 \xbfC\xf3mo se crea un negocio?",id:"-c\xf3mo-se-crea-un-negocio",level:2},{value:"\ud83e\uddea Ejemplo de respuesta",id:"-ejemplo-de-respuesta",level:2},{value:"\ud83d\udd0d Obtener negocio por ID",id:"-obtener-negocio-por-id",level:2},{value:"\u270f\ufe0f Editar informaci\xf3n del negocio",id:"\ufe0f-editar-informaci\xf3n-del-negocio",level:2},{value:"\u274c Soft delete de negocio",id:"-soft-delete-de-negocio",level:2},{value:"\ud83d\udee1\ufe0f Seguridad y contexto",id:"\ufe0f-seguridad-y-contexto",level:2},{value:"\ud83e\udde0 Validaciones importantes",id:"-validaciones-importantes",level:2},{value:"\u2705 Buenas pr\xe1cticas",id:"-buenas-pr\xe1cticas",level:2},{value:"\ud83d\ude80 Futuras mejoras",id:"-futuras-mejoras",level:2},{value:"\ud83e\udde9 Conclusi\xf3n",id:"-conclusi\xf3n",level:2}];function t(e){const n={blockquote:"blockquote",br:"br",code:"code",h2:"h2",hr:"hr",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,r.R)(),...e.components};return(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(n.p,{children:"El m\xf3dulo de negocios (o tenants) en Furiku representa a cada cliente del sistema: cafeter\xedas, restaurantes peque\xf1os, dark kitchens, food trucks, etc."}),"\n",(0,d.jsxs)(n.p,{children:["Cada negocio es independiente en datos y usuarios, y funciona como ",(0,d.jsx)(n.strong,{children:"unidad aislada"})," dentro de la arquitectura multitenant."]}),"\n",(0,d.jsx)(n.hr,{}),"\n",(0,d.jsxs)(n.h2,{id:"-qu\xe9-es-un-business",children:["\ud83e\udde9 \xbfQu\xe9 es un ",(0,d.jsx)(n.code,{children:"Business"}),"?"]}),"\n",(0,d.jsxs)(n.p,{children:["Una entidad ",(0,d.jsx)(n.code,{children:"Business"})," representa a un tenant \xfanico en Furiku. Todo usuario, producto, orden y operaci\xf3n est\xe1 relacionada con un ",(0,d.jsx)(n.code,{children:"tenantId"}),"."]}),"\n",(0,d.jsx)(n.hr,{}),"\n",(0,d.jsxs)(n.h2,{id:"-campos-principales-en-business",children:["\ud83e\uddfe Campos principales en ",(0,d.jsx)(n.code,{children:"Business"})]}),"\n",(0,d.jsxs)(n.table,{children:[(0,d.jsx)(n.thead,{children:(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.th,{children:"Campo"}),(0,d.jsx)(n.th,{children:"Descripci\xf3n"})]})}),(0,d.jsxs)(n.tbody,{children:[(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"tenantId"})}),(0,d.jsx)(n.td,{children:"Identificador \xfanico del negocio (usado como clave primaria)"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"name"})}),(0,d.jsx)(n.td,{children:"Nombre del negocio"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"rfc"})}),(0,d.jsx)(n.td,{children:"Registro Federal de Contribuyentes (para facturaci\xf3n SAT)"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"address"})}),(0,d.jsx)(n.td,{children:"Direcci\xf3n del local"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"plan"})}),(0,d.jsxs)(n.td,{children:["Tipo de plan contratado (",(0,d.jsx)(n.code,{children:"FREE"}),", ",(0,d.jsx)(n.code,{children:"PREMIUM"}),", etc.)"]})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"audit"})}),(0,d.jsx)(n.td,{children:"Informaci\xf3n embebida sobre qui\xe9n y cu\xe1ndo se cre\xf3/modific\xf3"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"isDeleted"})}),(0,d.jsx)(n.td,{children:"Bandera de eliminaci\xf3n l\xf3gica (soft delete)"})]})]})]}),"\n",(0,d.jsx)(n.hr,{}),"\n",(0,d.jsxs)(n.h2,{id:"-qu\xe9-representa-un-tenant",children:["\ud83d\udce6 \xbfQu\xe9 representa un ",(0,d.jsx)(n.code,{children:"tenant"}),"?"]}),"\n",(0,d.jsxs)(n.p,{children:["En Furiku, un tenant es ",(0,d.jsx)(n.strong,{children:"una unidad de negocio completamente separada"}),", con su propio:"]}),"\n",(0,d.jsxs)(n.ul,{children:["\n",(0,d.jsx)(n.li,{children:"Conjunto de usuarios"}),"\n",(0,d.jsx)(n.li,{children:"Inventario"}),"\n",(0,d.jsx)(n.li,{children:"\xd3rdenes"}),"\n",(0,d.jsx)(n.li,{children:"Facturaci\xf3n"}),"\n",(0,d.jsx)(n.li,{children:"Reportes"}),"\n"]}),"\n",(0,d.jsx)(n.hr,{}),"\n",(0,d.jsx)(n.h2,{id:"-c\xf3mo-se-crea-un-negocio",children:"\ud83d\udee0 \xbfC\xf3mo se crea un negocio?"}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-json",children:'    POST /api/businesses\n\n    {\n        "tenantId": "cafe-centro",\n        "name": "Caf\xe9 Centro",\n        "rfc": "CAC010203AB9",\n        "address": "Av. Principal 123",\n        "plan": "FREE"\n    }\n'})}),"\n",(0,d.jsxs)(n.blockquote,{children:["\n",(0,d.jsxs)(n.p,{children:["\u26a0\ufe0f El ",(0,d.jsx)(n.code,{children:"tenantId"})," debe ser \xfanico. Si ya existe, se devolver\xe1 un error ",(0,d.jsx)(n.code,{children:"BUSINESS_ALREADY_EXISTS"}),"."]}),"\n"]}),"\n",(0,d.jsx)(n.hr,{}),"\n",(0,d.jsx)(n.h2,{id:"-ejemplo-de-respuesta",children:"\ud83e\uddea Ejemplo de respuesta"}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-json",children:'\n    {\n        "tenantId": "cafe-centro",\n        "name": "Caf\xe9 Centro",\n        "plan": "FREE"\n    }\n'})}),"\n",(0,d.jsx)(n.hr,{}),"\n",(0,d.jsx)(n.h2,{id:"-obtener-negocio-por-id",children:"\ud83d\udd0d Obtener negocio por ID"}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-java",children:"\n    GET /api/businesses/{tenantId}\n"})}),"\n",(0,d.jsxs)(n.p,{children:["Este endpoint retorna el negocio ",(0,d.jsx)(n.strong,{children:"si no ha sido eliminado"})," (",(0,d.jsx)(n.code,{children:"isDeleted = false"}),")."]}),"\n",(0,d.jsx)(n.hr,{}),"\n",(0,d.jsx)(n.h2,{id:"\ufe0f-editar-informaci\xf3n-del-negocio",children:"\u270f\ufe0f Editar informaci\xf3n del negocio"}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-json",children:'\n    PUT /api/businesses/{tenantId}\n\n    {\n        "name": "Nuevo Caf\xe9 Centro",\n        "rfc": "CAC010203AB9",\n        "address": "Av. Nueva 456",\n        "plan": "PREMIUM"\n    }\n'})}),"\n",(0,d.jsxs)(n.blockquote,{children:["\n",(0,d.jsxs)(n.p,{children:["Solo usuarios con rol ",(0,d.jsx)(n.code,{children:"OWNER"})," pueden editar el negocio, y deben pertenecer al mismo tenant."]}),"\n"]}),"\n",(0,d.jsx)(n.hr,{}),"\n",(0,d.jsx)(n.h2,{id:"-soft-delete-de-negocio",children:"\u274c Soft delete de negocio"}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-java",children:"\n    DELETE /api/businesses/{tenantId}\n"})}),"\n",(0,d.jsxs)(n.p,{children:["Marca el negocio como eliminado (",(0,d.jsx)(n.code,{children:"isDeleted = true"}),") y registra:"]}),"\n",(0,d.jsxs)(n.ul,{children:["\n",(0,d.jsx)(n.li,{children:(0,d.jsx)(n.code,{children:"deletedAt"})}),"\n",(0,d.jsx)(n.li,{children:(0,d.jsx)(n.code,{children:"deletedBy"})}),"\n"]}),"\n",(0,d.jsxs)(n.p,{children:["El negocio ya no podr\xe1 ser consultado ni modificado. Esta acci\xf3n ",(0,d.jsx)(n.strong,{children:"solo puede realizarla el OWNER del tenant"}),"."]}),"\n",(0,d.jsx)(n.hr,{}),"\n",(0,d.jsx)(n.h2,{id:"\ufe0f-seguridad-y-contexto",children:"\ud83d\udee1\ufe0f Seguridad y contexto"}),"\n",(0,d.jsx)(n.p,{children:"Todas las operaciones sobre negocios est\xe1n protegidas por:"}),"\n",(0,d.jsxs)(n.ul,{children:["\n",(0,d.jsxs)(n.li,{children:[(0,d.jsx)(n.code,{children:'@RolesAllowed("OWNER")'})," en endpoints sensibles"]}),"\n",(0,d.jsxs)(n.li,{children:["Validaci\xf3n del ",(0,d.jsx)(n.code,{children:"tenantId"})," actual contra el ",(0,d.jsx)(n.code,{children:"CurrentUser"})]}),"\n"]}),"\n",(0,d.jsx)(n.hr,{}),"\n",(0,d.jsx)(n.h2,{id:"-validaciones-importantes",children:"\ud83e\udde0 Validaciones importantes"}),"\n",(0,d.jsxs)(n.table,{children:[(0,d.jsx)(n.thead,{children:(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.th,{children:"Validaci\xf3n"}),(0,d.jsx)(n.th,{children:"Resultado"})]})}),(0,d.jsxs)(n.tbody,{children:[(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:"Tenant ya existe"}),(0,d.jsxs)(n.td,{children:["\u274c Error ",(0,d.jsx)(n.code,{children:"409 Conflict"})," con mensaje internacionalizado"]})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:"Tenant no encontrado"}),(0,d.jsxs)(n.td,{children:["\u274c Error ",(0,d.jsx)(n.code,{children:"404 Not Found"})]})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:"Tenant eliminado"}),(0,d.jsx)(n.td,{children:"\u274c No se permite modificar ni consultar"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:"Modificaci\xf3n por otro rol"}),(0,d.jsxs)(n.td,{children:["\u274c Error ",(0,d.jsx)(n.code,{children:"403 Forbidden"})]})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:"Acceso cruzado de tenants"}),(0,d.jsxs)(n.td,{children:["\u274c Rechazado mediante ",(0,d.jsx)(n.code,{children:"CurrentUser.getTenantId()"})]})]})]})]}),"\n",(0,d.jsx)(n.hr,{}),"\n",(0,d.jsx)(n.h2,{id:"-buenas-pr\xe1cticas",children:"\u2705 Buenas pr\xe1cticas"}),"\n",(0,d.jsxs)(n.ul,{children:["\n",(0,d.jsxs)(n.li,{children:["Siempre valida que ",(0,d.jsx)(n.code,{children:"CurrentUser.getTenantId()"})," coincida con el tenant objetivo"]}),"\n",(0,d.jsxs)(n.li,{children:["Utiliza ",(0,d.jsx)(n.code,{children:"AuditHelper.generate()"})," en cada operaci\xf3n que modifique el negocio"]}),"\n",(0,d.jsxs)(n.li,{children:["Usa ",(0,d.jsx)(n.code,{children:"businessRepository.findByIdActive(tenantId)"})," para evitar errores con eliminados"]}),"\n",(0,d.jsxs)(n.li,{children:["Solo permite edici\xf3n y eliminaci\xf3n a ",(0,d.jsx)(n.code,{children:"OWNER"})," del mismo tenant"]}),"\n",(0,d.jsxs)(n.li,{children:["Si vas a mostrar negocios, aseg\xfarate de filtrarlos por ",(0,d.jsx)(n.code,{children:"deleted = false"})]}),"\n"]}),"\n",(0,d.jsx)(n.hr,{}),"\n",(0,d.jsx)(n.h2,{id:"-futuras-mejoras",children:"\ud83d\ude80 Futuras mejoras"}),"\n",(0,d.jsxs)(n.ul,{children:["\n",(0,d.jsx)(n.li,{children:"Historial de cambios del negocio (con Hibernate Envers)"}),"\n",(0,d.jsxs)(n.li,{children:["L\xedmite de funcionalidades seg\xfan ",(0,d.jsx)(n.code,{children:"plan"})," (",(0,d.jsx)(n.code,{children:"FREE"}),", ",(0,d.jsx)(n.code,{children:"PREMIUM"}),")"]}),"\n",(0,d.jsx)(n.li,{children:"Panel administrativo de planes y facturaci\xf3n"}),"\n",(0,d.jsx)(n.li,{children:"Asociaci\xf3n de m\xfaltiples sucursales a un mismo negocio"}),"\n",(0,d.jsx)(n.li,{children:"Activaci\xf3n/desactivaci\xf3n temporal por falta de pago"}),"\n"]}),"\n",(0,d.jsx)(n.hr,{}),"\n",(0,d.jsx)(n.h2,{id:"-conclusi\xf3n",children:"\ud83e\udde9 Conclusi\xf3n"}),"\n",(0,d.jsxs)(n.p,{children:["El m\xf3dulo ",(0,d.jsx)(n.code,{children:"Business"})," es la base de la arquitectura multitenant de Furiku.",(0,d.jsx)(n.br,{}),"\n","Cada operaci\xf3n en el sistema depende del tenant activo, asegurando:"]}),"\n",(0,d.jsxs)(n.ul,{children:["\n",(0,d.jsx)(n.li,{children:"Separaci\xf3n de datos"}),"\n",(0,d.jsx)(n.li,{children:"Seguridad"}),"\n",(0,d.jsx)(n.li,{children:"Escalabilidad"}),"\n",(0,d.jsx)(n.li,{children:"Independencia entre clientes"}),"\n"]}),"\n",(0,d.jsxs)(n.blockquote,{children:["\n",(0,d.jsxs)(n.p,{children:["\ud83c\udfd7\ufe0f Todo parte del ",(0,d.jsx)(n.code,{children:"tenantId"}),", y este m\xf3dulo garantiza que cada cafeter\xeda, dark kitchen o restaurante tenga su espacio propio dentro de Furiku."]}),"\n"]})]})}function u(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,d.jsx)(n,{...e,children:(0,d.jsx)(t,{...e})}):t(e)}},8453:(e,n,s)=>{s.d(n,{R:()=>c,x:()=>o});var i=s(6540);const d={},r=i.createContext(d);function c(e){const n=i.useContext(r);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(d):e.components||d:c(e.components),i.createElement(r.Provider,{value:n},e.children)}}}]);